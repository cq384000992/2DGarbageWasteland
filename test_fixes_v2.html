<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿®å¤éªŒè¯æµ‹è¯• v2</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #0f0f23;
            color: white;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #4ecdc4;
            border-radius: 5px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 3px;
        }
        .pass {
            background-color: #2d5a2d;
            border-left: 4px solid #4caf50;
        }
        .info {
            background-color: #2d4a5a;
            border-left: 4px solid #2196f3;
        }
        .warning {
            background-color: #5a4a2d;
            border-left: 4px solid #ff9800;
        }
        button {
            background-color: #4ecdc4;
            color: #0f0f23;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #45b7b8;
        }
        #log {
            background-color: #1a1a1a;
            padding: 10px;
            border-radius: 5px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .fix-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .fix-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #4ecdc4;
            border-radius: 8px;
            padding: 15px;
        }
        .fix-card h3 {
            color: #4ecdc4;
            margin-bottom: 10px;
        }
        .fix-item {
            margin: 5px 0;
            font-size: 14px;
        }
        .bullet-fix { border-color: #4caf50; }
        .monster-fix { border-color: #ff9800; }
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .stats-table th, .stats-table td {
            border: 1px solid #4ecdc4;
            padding: 8px;
            text-align: center;
        }
        .stats-table th {
            background-color: rgba(78, 205, 196, 0.2);
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ ä¿®å¤éªŒè¯æµ‹è¯• v2</h1>
    
    <div class="test-section">
        <h2>ğŸ“‹ ä¿®å¤å†…å®¹æ€»ç»“</h2>
        <div class="fix-summary">
            <div class="fix-card bullet-fix">
                <h3>ğŸ”« å­å¼¹æ¶ˆå¤±é—®é¢˜ä¿®å¤</h3>
                <div class="fix-item">âœ… é—®é¢˜: å­å¼¹æ‰“ç€æ‰“ç€å°±æ¶ˆå¤±äº†</div>
                <div class="fix-item">âœ… åŸå› : è¾¹ç•Œæ£€æŸ¥é€»è¾‘é”™è¯¯</div>
                <div class="fix-item">âœ… ä¿®å¤: è°ƒæ•´è¾¹ç•Œæ£€æŸ¥èŒƒå›´</div>
                <div class="fix-item">âœ… æ•ˆæœ: å­å¼¹å‘ä¸Šç§»åŠ¨5000åƒç´ åæ‰é”€æ¯</div>
            </div>
            <div class="fix-card monster-fix">
                <h3>ğŸ‘¹ æ€ªç‰©é‡å é—®é¢˜ä¿®å¤</h3>
                <div class="fix-item">âœ… é—®é¢˜: æ€ªç‰©å¤§é‡é‡å </div>
                <div class="fix-item">âœ… åŸå› : é—´è·è®¾ç½®è¿‡å¤§(100px)</div>
                <div class="fix-item">âœ… ä¿®å¤: è°ƒæ•´ä¸º50åƒç´ æœ€å°é—´è·</div>
                <div class="fix-item">âœ… æ•ˆæœ: æ€ªç‰©é—´ä¿æŒ50åƒç´ é—´è·</div>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š æ–°å…³å¡é…ç½®</h2>
        <table class="stats-table">
            <thead>
                <tr>
                    <th>å…³å¡</th>
                    <th>éš¾åº¦</th>
                    <th>æ—¶é•¿</th>
                    <th>æ²¹æ¡¶æ€ª</th>
                    <th>UFOç‚®å¡”</th>
                    <th>å·¨å‹æ€ª</th>
                    <th>æ€»æ€ªç‰©</th>
                    <th>å¯†åº¦</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>å…³å¡1</td>
                    <td>ç®€å•</td>
                    <td>120ç§’</td>
                    <td>40</td>
                    <td>20</td>
                    <td>8</td>
                    <td><strong>68</strong></td>
                    <td>0.57/ç§’</td>
                </tr>
                <tr>
                    <td>å…³å¡2</td>
                    <td>ä¸­ç­‰</td>
                    <td>180ç§’</td>
                    <td>55</td>
                    <td>35</td>
                    <td>15</td>
                    <td><strong>105</strong></td>
                    <td>0.58/ç§’</td>
                </tr>
                <tr>
                    <td>å…³å¡3</td>
                    <td>å›°éš¾</td>
                    <td>240ç§’</td>
                    <td>70</td>
                    <td>50</td>
                    <td>25</td>
                    <td><strong>145</strong></td>
                    <td>0.60/ç§’</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="test-section">
        <h2>ğŸ§ª æµ‹è¯•åŠŸèƒ½</h2>
        <button onclick="testBulletFix()">æµ‹è¯•å­å¼¹ä¿®å¤</button>
        <button onclick="testMonsterSpacing()">æµ‹è¯•æ€ªç‰©é—´è·</button>
        <button onclick="testLevelConfig()">æµ‹è¯•å…³å¡é…ç½®</button>
        <button onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š æµ‹è¯•ç»“æœ</h2>
        <div id="results"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“ æµ‹è¯•æ—¥å¿—</h2>
        <div id="log"></div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
            document.getElementById('results').innerHTML = '';
        }

        function addResult(type, title, message) {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            results.innerHTML += `
                <div class="test-result ${type}">
                    <strong>[${timestamp}] ${title}</strong><br>
                    ${message}
                </div>
            `;
        }

        function testBulletFix() {
            log('ğŸ”« å¼€å§‹æµ‹è¯•å­å¼¹ä¿®å¤...');
            
            // æ¨¡æ‹Ÿå­å¼¹è¾¹ç•Œæ£€æŸ¥
            const bulletTests = [
                { y: -1000, expected: 'å­˜æ´»', description: 'å­å¼¹å‘ä¸Šç§»åŠ¨1000åƒç´ ' },
                { y: -3000, expected: 'å­˜æ´»', description: 'å­å¼¹å‘ä¸Šç§»åŠ¨3000åƒç´ ' },
                { y: -5000, expected: 'å­˜æ´»', description: 'å­å¼¹å‘ä¸Šç§»åŠ¨5000åƒç´ ï¼ˆè¾¹ç•Œï¼‰' },
                { y: -5001, expected: 'é”€æ¯', description: 'å­å¼¹å‘ä¸Šç§»åŠ¨5001åƒç´ ï¼ˆè¶…å‡ºè¾¹ç•Œï¼‰' },
                { y: 1000, expected: 'å­˜æ´»', description: 'å­å¼¹åœ¨å±å¹•å†…' },
                { y: 3000, expected: 'å­˜æ´»', description: 'å­å¼¹åœ¨å±å¹•ä¸‹æ–¹1000åƒç´ ' },
                { y: 4000, expected: 'é”€æ¯', description: 'å­å¼¹åœ¨å±å¹•ä¸‹æ–¹2000åƒç´ ï¼ˆè¶…å‡ºè¾¹ç•Œï¼‰' }
            ];
            
            let allPassed = true;
            bulletTests.forEach(test => {
                let result;
                if (test.y < -5000 || test.y > 2560 + 2000) {
                    result = 'é”€æ¯';
                } else {
                    result = 'å­˜æ´»';
                }
                
                const passed = result === test.expected;
                allPassed = allPassed && passed;
                
                log(`${test.description}: ${result} ${passed ? 'âœ…' : 'âŒ'}`);
            });
            
            if (allPassed) {
                log('âœ… å­å¼¹è¾¹ç•Œæ£€æŸ¥æµ‹è¯•é€šè¿‡');
                addResult('pass', 'å­å¼¹ä¿®å¤', 'å­å¼¹è¾¹ç•Œæ£€æŸ¥é€»è¾‘æ­£ç¡®');
            } else {
                log('âŒ å­å¼¹è¾¹ç•Œæ£€æŸ¥æµ‹è¯•å¤±è´¥');
                addResult('warning', 'å­å¼¹ä¿®å¤', 'å­å¼¹è¾¹ç•Œæ£€æŸ¥é€»è¾‘æœ‰é—®é¢˜');
            }
        }

        function testMonsterSpacing() {
            log('ğŸ‘¹ å¼€å§‹æµ‹è¯•æ€ªç‰©é—´è·...');
            
            // æ¨¡æ‹Ÿæ€ªç‰©é—´è·è®¡ç®—
            const monsterTypes = [
                { name: 'BarrelMonster', width: 300, height: 450 },
                { name: 'UFOTurret', width: 400, height: 600 },
                { name: 'GiantMelee', width: 500, height: 750 }
            ];
            
            const spacingTests = [
                { type1: 'BarrelMonster', type2: 'BarrelMonster', expected: 350 },
                { type1: 'BarrelMonster', type2: 'UFOTurret', expected: 400 },
                { type1: 'BarrelMonster', type2: 'GiantMelee', expected: 450 },
                { type1: 'UFOTurret', type2: 'UFOTurret', expected: 450 },
                { type1: 'UFOTurret', type2: 'GiantMelee', expected: 500 },
                { type1: 'GiantMelee', type2: 'GiantMelee', expected: 550 }
            ];
            
            let allPassed = true;
            spacingTests.forEach(test => {
                const monster1 = monsterTypes.find(m => m.name === test.type1);
                const monster2 = monsterTypes.find(m => m.name === test.type2);
                
                const minDistance = (monster1.width + monster2.width) / 2 + 50;
                const passed = minDistance === test.expected;
                allPassed = allPassed && passed;
                
                log(`${test.type1} + ${test.type2}: ${minDistance}px ${passed ? 'âœ…' : 'âŒ'}`);
            });
            
            // æµ‹è¯•ç”ŸæˆåŒºåŸŸ
            const playAreaLeft = 360;
            const spawnWidth = 660; // 720 - 60
            const spawnLeft = 390; // 360 + 30
            
            log(`ç”ŸæˆåŒºåŸŸ: X=${spawnLeft} åˆ° ${spawnLeft + spawnWidth} (å®½åº¦${spawnWidth})`);
            
            // æ£€æŸ¥æœ€å¤§æ€ªç‰©ç»„åˆæ˜¯å¦èƒ½å®¹çº³
            const maxRequiredSpace = 550; // GiantMelee + GiantMelee
            const availableSpace = spawnWidth;
            
            if (availableSpace >= maxRequiredSpace) {
                log(`âœ… å¯ç”¨ç©ºé—´${availableSpace}px >= æœ€å¤§éœ€æ±‚${maxRequiredSpace}px`);
                addResult('pass', 'æ€ªç‰©é—´è·', 'ç”ŸæˆåŒºåŸŸè¶³å¤Ÿå®¹çº³æœ€å¤§æ€ªç‰©ç»„åˆ');
            } else {
                log(`âŒ å¯ç”¨ç©ºé—´${availableSpace}px < æœ€å¤§éœ€æ±‚${maxRequiredSpace}px`);
                addResult('warning', 'æ€ªç‰©é—´è·', 'ç”ŸæˆåŒºåŸŸæ— æ³•å®¹çº³æœ€å¤§æ€ªç‰©ç»„åˆ');
                allPassed = false;
            }
            
            if (allPassed) {
                log('âœ… æ€ªç‰©é—´è·æµ‹è¯•é€šè¿‡');
                addResult('pass', 'æ€ªç‰©é—´è·', 'æ€ªç‰©é—´è·è®¡ç®—æ­£ç¡®ï¼Œç”ŸæˆåŒºåŸŸå……è¶³');
            } else {
                log('âŒ æ€ªç‰©é—´è·æµ‹è¯•å¤±è´¥');
                addResult('warning', 'æ€ªç‰©é—´è·', 'æ€ªç‰©é—´è·è®¡ç®—æˆ–ç”ŸæˆåŒºåŸŸæœ‰é—®é¢˜');
            }
        }

        function testLevelConfig() {
            log('ğŸ“‹ å¼€å§‹æµ‹è¯•å…³å¡é…ç½®...');
            
            const levels = [
                { level: 1, barrel: 40, ufo: 20, giant: 8, total: 68, duration: 120 },
                { level: 2, barrel: 55, ufo: 35, giant: 15, total: 105, duration: 180 },
                { level: 3, barrel: 70, ufo: 50, giant: 25, total: 145, duration: 240 }
            ];
            
            let allPassed = true;
            levels.forEach(level => {
                const density = (level.total / level.duration).toFixed(2);
                const barrelRatio = (level.barrel / level.total * 100).toFixed(1);
                const ufoRatio = (level.ufo / level.total * 100).toFixed(1);
                const giantRatio = (level.giant / level.total * 100).toFixed(1);
                
                log(`å…³å¡${level.level}: æ€»æ€ªç‰©=${level.total}, å¯†åº¦=${density}/ç§’`);
                log(`  æ²¹æ¡¶æ€ª: ${level.barrel}ä¸ª (${barrelRatio}%), UFO: ${level.ufo}ä¸ª (${ufoRatio}%), å·¨å‹æ€ª: ${level.giant}ä¸ª (${giantRatio}%)`);
                
                // æ£€æŸ¥é…ç½®æ˜¯å¦åˆç†
                const isReasonable = level.total >= 60 && level.total <= 150 && 
                                   barrelRatio >= 50 && ufoRatio >= 15 && giantRatio >= 5;
                
                if (!isReasonable) allPassed = false;
                
                addResult(isReasonable ? 'pass' : 'warning', `å…³å¡${level.level}é…ç½®`, 
                    `æ€»æ€ªç‰©: ${level.total} | å¯†åº¦: ${density}/ç§’ | åˆ†å¸ƒ: ${barrelRatio}%/${ufoRatio}%/${giantRatio}% ${isReasonable ? 'âœ…' : 'âš ï¸'}`);
            });
            
            if (allPassed) {
                log('âœ… å…³å¡é…ç½®æµ‹è¯•é€šè¿‡');
                addResult('pass', 'å…³å¡é…ç½®', 'æ‰€æœ‰å…³å¡é…ç½®åˆç†');
            } else {
                log('âŒ å…³å¡é…ç½®æµ‹è¯•å¤±è´¥');
                addResult('warning', 'å…³å¡é…ç½®', 'éƒ¨åˆ†å…³å¡é…ç½®ä¸åˆç†');
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = function() {
            log('ğŸš€ ä¿®å¤éªŒè¯æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            log('ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...');
        };
    </script>
</body>
</html>



